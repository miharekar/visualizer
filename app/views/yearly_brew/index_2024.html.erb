<% content_for(:html_title) { "Visualizer | Bean Counting 2024: Your Year on Visualizer" } %>
<div class="flex flex-col items-center px-4 mx-auto my-24 sm:my-32 gap-y-24 sm:gap-y-32 max-w-7xl sm:px-6 lg:px-8 dark:text-neutral-200">
  <div class="px-6 bg-white lg:px-8">
    <div class="max-w-2xl mx-auto text-center">
      <p class="font-semibold text-terracotta-600 text-base/7">Your Year on Visualizer</p>
      <h1 class="mt-2 font-serif text-5xl font-semibold tracking-tight text-gray-900 text-balance sm:text-7xl">Bean Counting 2024</h1>
      <p class="mt-8 text-lg font-medium text-gray-500 text-pretty sm:text-xl/8">
        <% if @yearly_brew.shots_this_year.any? %>
          This is your personal coffee chronicle of the year.
          A data-driven journey through every bean you've ground, every shot you've pulled, and every sip you've savored.
          Well, at least the ones I could find in my database. ðŸ˜…
        <% else %>
          You haven't uploaded any shots this year. ðŸ˜”
          Hopefully, you'll have some to look back on next year! I can't wait to see your coffee journey unfold.
        <% end %>
      </p>
    </div>
  </div>
  <% if @yearly_brew.shots_this_year.any? %>
    <div class="flex flex-col max-w-2xl gap-8 mx-auto lg:mx-0 lg:max-w-none lg:flex-row lg:items-end">
      <div class="flex flex-col-reverse justify-between p-8 gap-x-16 gap-y-8 rounded-2xl bg-terracotta-50 sm:w-3/4 sm:max-w-md sm:flex-row-reverse sm:items-end lg:w-72 lg:max-w-none lg:flex-none lg:flex-col lg:items-start">
        <p class="flex-none text-3xl font-bold tracking-tight text-gray-900">
          <%= @yearly_brew.shots_this_year.count %>
        </p>
        <div class="sm:w-80 sm:shrink lg:w-auto lg:flex-none">
          <p class="text-lg font-semibold tracking-tight text-gray-900 text-balance">Shots pulled this year</p>
          <p class="mt-2 text-gray-600 text-base/7">Every shot tells a story of your coffee journey, from morning rituals to evening experiments.</p>
        </div>
      </div>
      <div class="flex flex-col-reverse justify-between p-8 bg-gray-900 gap-x-16 gap-y-8 rounded-2xl sm:flex-row-reverse sm:items-end lg:w-full lg:max-w-sm lg:flex-auto lg:flex-col lg:items-start lg:gap-y-44">
        <p class="flex-none text-3xl font-bold tracking-tight text-white">
          <%= @yearly_brew.amount_beans_used %> kg
        </p>
        <div class="sm:w-80 sm:shrink lg:w-auto lg:flex-none">
          <p class="text-lg font-semibold tracking-tight text-white text-balance">Coffee beans transformed into delicious shots</p>
          <p class="mt-2 text-gray-400 text-base/7">Each gram carefully measured and extracted to create your perfect cup of coffee.</p>
        </div>
      </div>
      <div class="flex flex-col-reverse justify-between p-8 gap-x-16 gap-y-8 rounded-2xl bg-terracotta-600 sm:w-11/12 sm:max-w-xl sm:flex-row-reverse sm:items-end lg:w-full lg:max-w-none lg:flex-auto lg:flex-col lg:items-start lg:gap-y-28">
        <p class="flex-none text-3xl font-bold tracking-tight text-white">
          <% hours, minutes, seconds = @yearly_brew.time_brewed(human: true) %>
          <% if hours > 0 %>
            <%= hours %> h <%= minutes %> min <%= seconds %> s
          <% else %>
            <%= minutes %> min <%= seconds %> s
          <% end %>
        </p>
        <div class="sm:w-80 sm:shrink lg:w-auto lg:flex-none">
          <p class="text-lg font-semibold tracking-tight text-white text-balance">Time dedicated to brewing</p>
          <p class="mt-2 text-base/7 text-terracotta-100">Every second well spent perfecting your craft and creating moments of coffee excellence throughout the year.</p>
        </div>
      </div>
    </div>
    <%
    stats = [
      {
        title: "Best Rated Coffee",
        stat: @yearly_brew.best_rated_coffee,
        description: "Your highest-rated coffee of the year. A true gem that stood out among all your brews."
      },
      {
        title: "Most Brewed Coffee",
        stat: @yearly_brew.most_brewed_coffee,
        description: "Your go-to coffee this year. Sometimes you find something that just works perfectly."
      },
      {
        title: "Most Used Profile",
        stat: @yearly_brew.most_used_profile,
        description: "Your favorite recipe for consistently great shots. A trusted companion in your coffee journey."
      },
      {
        title: "Average Enjoyment",
        stat: @yearly_brew.average_enjoyment,
        description: "The average rating of your shots this year. A testament to your consistency and skill in brewing great coffee."
      },
      {
        title: "Coffee Brewed",
        stat: "#{@yearly_brew.amount_brewed} kg",
        description: "The total amount of coffee you've transformed into delicious espresso this year. That's a lot of beans!"
      },
      {
        title: "Time Spent Brewing",
        stat: "#{@yearly_brew.time_brewed} minutes",
        description: "Time well spent perfecting your craft. Every minute dedicated to creating the perfect cup."
      },
      {
        title: "Busiest Month",
        stat: @yearly_brew.month_with_most_shots,
        description: "Your most active month for coffee brewing. When your espresso machine barely got a break!"
      },
      {
        title: "Most Active Day",
        stat: @yearly_brew.day_with_most_shots,
        description: "Your peak coffee day of the year. Must have been quite the caffeine-fueled adventure!"
      }
    ]
  %>
    <%= render "yearly_brew/bento_box_2024", stats: stats %>
    <% if Current.user.public? %>
      <div class="flex justify-center">
        <%= link_to yearly_brew_path(Current.user.slug), class: "inline-flex items-center gap-x-2 rounded-md bg-terracotta-600 px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-terracotta-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-terracotta-600" do %>
          <svg class="-ml-0.5 h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path d="M13 4.5a2.5 2.5 0 11.702 1.737L6.97 9.604a2.518 2.518 0 010 .792l6.733 3.367a2.5 2.5 0 11-.671 1.341l-6.733-3.367a2.5 2.5 0 110-3.475l6.733-3.366A2.52 2.52 0 0113 4.5z" />
          </svg>
          Open a shareable public page
        <% end %>
      </div>
    <% else %>
      <div class="flex flex-col items-center gap-y-4 max-w-prose">
        <p class="text-center">
          Want to share your coffee journey with friends and fellow enthusiasts?
          <br>
          <%= link_to "Make your profile public", edit_profiles_path, class: "text-terracotta-600 standard-link" %> to get a shareable link to your Bean Counting!
        </p>
      </div>
    <% end %>
  <% end %>
</div>
