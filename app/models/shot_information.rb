class ShotInformation < ApplicationRecord
  prepend MemoWise
  include Profile

  belongs_to :shot, inverse_of: :information

  def extra
    super || {}
  end

  def profile_fields
    super || {}
  end

  def brewdata
    super || {}
  end

  def chart_data?
    !beanconqueror?
  end

  %w[beanconqueror gaggiuino gaggimate].each do |parser|
    define_method(:"#{parser}?") do
      parser_name == parser
    end
  end

  def parser_name
    parser.split("::").last.downcase
  end

  def parser
    brewdata.fetch("parser", "Parsers::DecentTcl")
  end
end

# == Schema Information
#
# Table name: shot_informations
#
#  id             :uuid             not null, primary key
#  brewdata       :jsonb
#  data           :jsonb
#  extra          :jsonb
#  profile_fields :jsonb
#  timeframe      :jsonb
#  shot_id        :uuid             not null
#
# Indexes
#
#  index_shot_informations_on_shot_id  (shot_id)
#
# Foreign Keys
#
#  fk_rails_...  (shot_id => shots.id)
#
